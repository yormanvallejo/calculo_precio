
<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Inventario Excel Pro - Edición Completa</title>
    <!-- Dependencias para ejecución local sin servidor -->
    <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/xlsx/dist/xlsx.full.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Plus Jakarta Sans', sans-serif; background-color: #f8fafc; color: #1e293b; }
        .glass { background: rgba(255, 255, 255, 0.9); backdrop-filter: blur(12px); border-bottom: 1px solid #e2e8f0; }
        .custom-scrollbar::-webkit-scrollbar { width: 6px; height: 6px; }
        .custom-scrollbar::-webkit-scrollbar-track { background: #f1f5f9; }
        .custom-scrollbar::-webkit-scrollbar-thumb { background: #cbd5e1; border-radius: 10px; }
        .custom-scrollbar::-webkit-scrollbar-thumb:hover { background: #94a3b8; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(8px); } to { opacity: 1; transform: translateY(0); } }
        .animate-fade { animation: fadeIn 0.3s ease-out forwards; }
        input[type="number"]::-webkit-inner-spin-button, 
        input[type="number"]::-webkit-outer-spin-button { -webkit-appearance: none; margin: 0; }
        .calculated-cell { background-color: #f1f5f9; font-weight: 500; color: #475569; }
        .editable-input { 
            width: 100%; 
            background: transparent; 
            border: 1px solid transparent; 
            padding: 4px 8px; 
            border-radius: 6px;
            transition: all 0.2s;
            font-size: 0.75rem;
        }
        .editable-input:hover { border-color: #cbd5e1; background: #fff; }
        .editable-input:focus { border-color: #6366f1; background: #fff; outline: none; box-shadow: 0 0 0 2px rgba(99, 102, 241, 0.1); }
        
        /* Columnas Inmovilizadas (Sticky) */
        .sticky-tipo { position: sticky; left: 0; background: white; z-index: 20; border-right: 1px solid #e2e8f0; min-width: 100px; width: 100px; }
        .sticky-comicion-col { position: sticky; left: 100px; background: white; z-index: 20; border-right: 1px solid #e2e8f0; min-width: 90px; width: 90px; }
        .sticky-articulo { position: sticky; left: 410px; background: white; z-index: 20; border-right: 2px solid #f1f5f9; min-width: 250px; width: 250px; box-shadow: 2px 0 5px rgba(0,0,0,0.03); }
        
        /* Ajuste para que Comercio y Fecha tengan ancho fijo y el offset de Artículo sea predecible */
        .col-comercio { min-width: 120px; width: 120px; }
        .col-fecha { min-width: 100px; width: 100px; }

        /* Headers necesitan mayor z-index */
        th.sticky-tipo, th.sticky-comicion-col, th.sticky-articulo { z-index: 30; background: #f8fafc; }
        tr:hover .sticky-tipo, tr:hover .sticky-comicion-col, tr:hover .sticky-articulo { background: #f8fafc; }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useMemo, useEffect, useCallback } = React;

        const App = () => {
            const [data, setData] = useState([]);
            const [tasa, setTasa] = useState(310.00); 
            const [globalComicion, setGlobalComicion] = useState(0.07); 
            const [filter, setFilter] = useState('');
            const [view, setView] = useState('summary'); 
            const [isLoading, setIsLoading] = useState(false);

            useEffect(() => {
                const savedTasa = localStorage.getItem('app_tasa_v3');
                const savedGlobalCom = localStorage.getItem('app_global_com_v3');
                if (savedTasa) setTasa(parseFloat(savedTasa));
                if (savedGlobalCom) setGlobalComicion(parseFloat(savedGlobalCom));
            }, []);

            const calculateItem = (item, gTasa = tasa, gCom = globalComicion) => {
                const row = { ...item };
                row.subtotal = (parseFloat(row.pUnitarioBs) || 0) * (parseFloat(row.cantidad) || 0);
                row.valorTotal = row.subtotal + (parseFloat(row.iva) || 0);
                row.costoTotalUsd = (parseFloat(row.tasaCompra) || 0) > 0 ? row.valorTotal / row.tasaCompra : 0;
                row.venta = (parseFloat(row.comicion) || 0) > 0 ? row.costoTotalUsd / row.comicion : 0;
                row.comicion2 = row.venta * gCom;
                row.ganacia = row.venta - (row.costoTotalUsd + row.comicion2);
                row.unitarioUsd = (parseFloat(row.unida) || 0) > 0 ? row.venta / row.unida : 0;
                row.precioUnitarioBs = row.unitarioUsd * gTasa;
                return row;
            };

            useEffect(() => {
                if (data.length > 0) {
                    setData(prev => prev.map(item => calculateItem(item)));
                }
            }, [tasa, globalComicion]);

            const handleFileUpload = (e) => {
                const file = e.target.files[0];
                if (!file) return;
                setIsLoading(true);
                const reader = new FileReader();
                reader.onload = (evt) => {
                    try {
                        const bstr = evt.target.result;
                        const wb = XLSX.read(bstr, { type: 'binary' });
                        const ws = wb.Sheets[wb.SheetNames[0]];
                        const raw = XLSX.utils.sheet_to_json(ws, { header: 1 });

                        let headerIdx = raw.findIndex(r => r.some(c => String(c || '').toLowerCase().includes('artículo')));
                        if (headerIdx === -1) headerIdx = 1;

                        if (raw[0]) {
                            if (raw[0][3] !== undefined) setTasa(parseFloat(raw[0][3]) || tasa);
                            if (raw[0][6] !== undefined) setGlobalComicion(parseFloat(raw[0][6]) || globalComicion);
                        }

                        const headers = raw[headerIdx].map(h => String(h || '').trim());
                        const rows = raw.slice(headerIdx + 1);
                        const find = (n) => headers.findIndex(h => h.toLowerCase().trim() === n.toLowerCase().trim());

                        const mapping = {
                            tipo: find('tipo'), comicion: find('Comicion'), comercio: find('Comercio'),
                            fecha: find('Fecha'), articulo: find('Artículo') !== -1 ? find('Artículo') : find('Articulo'),
                            cantidad: find('Cantidad'), unida: find('Unida'), pUnitarioBs: find('P, Unitario (Bs,)'),
                            iva: find('IVA (%)'), tasaCompra: find('Tasa compra')
                        };

                        const formatted = rows.filter(r => r[mapping.articulo]).map((r, i) => {
                            let obj = { id: Date.now() + i };
                            Object.keys(mapping).forEach(k => obj[k] = r[mapping[k]] || (k === 'iva' ? '0' : ''));
                            return calculateItem(obj);
                        });
                        setData(formatted);
                    } catch (err) { alert("Error al cargar"); } finally { setIsLoading(false); }
                };
                reader.readAsBinaryString(file);
            };

            const addNewItem = () => {
                const newItem = calculateItem({
                    id: Date.now(), tipo: 'NUEVO', comicion: 0.65, comercio: '-', fecha: new Date().toLocaleDateString(),
                    articulo: 'Nuevo Artículo', cantidad: 1, unida: 1, pUnitarioBs: 0, iva: 0, tasaCompra: tasa
                });
                setData([...data, newItem]);
                setView('details');
            };

            const updateField = (id, field, value) => {
                setData(prev => prev.map(item => item.id === id ? calculateItem({ ...item, [field]: value }) : item));
            };

            const exportExcelWithFormulas = () => {
                if (data.length === 0) return;
                const headers = [
                    "tipo", "Comicion", "Comercio", "Fecha", "Artículo", "Cantidad", "Unida", "P, Unitario (Bs,)", 
                    "IVA (%)", "subtotal", "Valor Total", "Tasa compra", "costoTotal $", "Comicion", "Ganacia", "cero", 
                    "Venta", "unitario$", "precio unitario BS"
                ];
                const wb = XLSX.utils.book_new();
                const wsData = [["", "TASA", "", tasa, "", "Comicion", globalComicion], headers];
                const ws = XLSX.utils.aoa_to_sheet(wsData);
                data.forEach((item, idx) => {
                    const r = idx + 3;
                    const row = [
                        item.tipo, item.comicion, item.comercio, item.fecha, item.articulo, item.cantidad, item.unida, item.pUnitarioBs, item.iva,
                        { f: `H${r}*F${r}` }, { f: `J${r}+I${r}` }, item.tasaCompra, { f: `K${r}/L${r}` }, { f: `Q${r}*$G$1` }, 
                        { f: `Q${r}-(M${r}+N${r})` }, 0, { f: `M${r}/B${r}` }, { f: `Q${r}/G${r}` }, { f: `R${r}*$D$1` }
                    ];
                    XLSX.utils.sheet_add_aoa(ws, [row], { origin: -1 });
                });
                XLSX.utils.book_append_sheet(wb, ws, "Inventario");
                XLSX.writeFile(wb, `Inventario_${new Date().toISOString().slice(0,10)}.xlsx`);
            };

            const filteredData = useMemo(() => {
                const q = filter.toLowerCase();
                return data.filter(i => String(i.articulo).toLowerCase().includes(q) || String(i.tipo).toLowerCase().includes(q));
            }, [data, filter]);

            const fmt = (v, c = '$') => new Intl.NumberFormat('es-VE', { style: 'currency', currency: c === '$' ? 'USD' : 'VES' }).format(v).replace('USD', '$').replace('VES', 'Bs.');

            return (
                <div className="min-h-screen flex flex-col">
                    <header className="glass sticky top-0 z-50 px-6 py-4">
                        <div className="max-w-[1800px] mx-auto flex flex-col lg:flex-row items-center justify-between gap-6">
                            <div className="flex items-center gap-4">
                                <div className="bg-indigo-600 p-3 rounded-2xl shadow-lg shadow-indigo-100">
                                    <svg className="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth="2" d="M9 17v-2m3 2v-4m3 4v-6m2 10H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path></svg>
                                </div>
                                <div>
                                    <h1 className="text-xl font-extrabold text-slate-800 tracking-tight">Inventario Pro</h1>
                                    <p className="text-[10px] text-slate-400 font-bold uppercase tracking-widest">Sistema de Gestión de Precios</p>
                                </div>
                            </div>

                            <div className="flex-1 max-w-md w-full relative">
                                <input type="text" placeholder="Buscar artículo o categoría..." className="w-full pl-12 pr-4 py-2.5 bg-slate-100 border-none rounded-2xl focus:ring-2 focus:ring-indigo-500 transition-all text-sm outline-none" value={filter} onChange={(e) => setFilter(e.target.value)} />
                                <svg className="w-5 h-5 absolute left-4 top-2.5 text-slate-400" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path></svg>
                            </div>

                            <div className="flex items-center gap-4">
                                <div className="bg-slate-50 border px-3 py-1.5 rounded-xl flex flex-col items-center">
                                    <span className="text-[9px] font-bold text-slate-400 uppercase">Tasa Global (D1)</span>
                                    <input type="number" className="w-20 bg-transparent text-center font-bold text-indigo-600 outline-none" value={tasa} onChange={(e) => { setTasa(parseFloat(e.target.value) || 0); localStorage.setItem('app_tasa_v3', e.target.value); }} />
                                </div>
                                <div className="bg-slate-50 border px-3 py-1.5 rounded-xl flex flex-col items-center">
                                    <span className="text-[9px] font-bold text-slate-400 uppercase">Comisión (G1)</span>
                                    <input type="number" step="0.01" className="w-16 bg-transparent text-center font-bold text-amber-600 outline-none" value={globalComicion} onChange={(e) => { setGlobalComicion(parseFloat(e.target.value) || 0); localStorage.setItem('app_global_com_v3', e.target.value); }} />
                                </div>
                                <div className="flex bg-slate-100 p-1 rounded-xl border">
                                    <button onClick={() => setView('summary')} className={`px-4 py-1.5 rounded-lg text-xs font-bold transition-all ${view === 'summary' ? 'bg-white shadow text-indigo-600' : 'text-slate-500'}`}>Resumen</button>
                                    <button onClick={() => setView('details')} className={`px-4 py-1.5 rounded-lg text-xs font-bold transition-all ${view === 'details' ? 'bg-white shadow text-indigo-600' : 'text-slate-500'}`}>Detalles</button>
                                </div>
                                {data.length > 0 && (
                                    <button onClick={exportExcelWithFormulas} className="bg-emerald-600 hover:bg-emerald-700 text-white px-5 py-2.5 rounded-xl text-xs font-bold shadow-lg shadow-emerald-100 transition-all flex items-center gap-2">
                                        <svg className="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"></path></svg>
                                        Exportar
                                    </button>
                                )}
                            </div>
                        </div>
                    </header>

                    <main className="max-w-[1800px] mx-auto w-full px-6 py-10 flex-grow">
                        {data.length === 0 ? (
                            <div className="h-[60vh] flex flex-col items-center justify-center bg-white border border-slate-200 rounded-[2.5rem] shadow-sm animate-fade">
                                <div className="mb-8 p-8 bg-indigo-50 rounded-full">
                                    <svg className="w-16 h-16 text-indigo-600" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth="1.5" d="M9 13h6m-3-3v6m5 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path></svg>
                                </div>
                                <h2 className="text-2xl font-extrabold text-slate-800 mb-2">Comienza tu Gestión</h2>
                                <p className="text-slate-500 mb-10 text-center max-w-sm">Sube tu inventario para calcular precios, editar márgenes y exportar con fórmulas.</p>
                                <div className="flex gap-4">
                                    <label className="bg-indigo-600 hover:bg-indigo-700 text-white px-8 py-4 rounded-2xl font-bold shadow-xl shadow-indigo-100 cursor-pointer transition-all transform hover:-translate-y-1">
                                        Cargar Hoja Excel
                                        <input type="file" className="hidden" accept=".xlsx,.xls" onChange={handleFileUpload} />
                                    </label>
                                    <button onClick={addNewItem} className="bg-white border-2 border-indigo-600 text-indigo-600 px-8 py-4 rounded-2xl font-bold hover:bg-indigo-50 transition-all transform hover:-translate-y-1">
                                        Crear desde Cero
                                    </button>
                                </div>
                            </div>
                        ) : (
                            <div className="animate-fade space-y-8">
                                <div className="flex justify-between items-center">
                                    <h2 className="text-2xl font-extrabold text-slate-800">{view === 'summary' ? 'Resumen de Precios' : 'Panel de Edición Detallada'}</h2>
                                    <button onClick={addNewItem} className="bg-indigo-100 text-indigo-700 hover:bg-indigo-200 px-5 py-2 rounded-xl text-xs font-bold flex items-center gap-2 transition-all">
                                        <svg className="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path d="M12 4v16m8-8H4"></path></svg>
                                        Añadir Artículo
                                    </button>
                                </div>

                                {view === 'summary' ? (
                                    <div className="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 2xl:grid-cols-5 gap-6">
                                        {filteredData.map(item => (
                                            <div key={item.id} className="bg-white p-6 rounded-3xl border border-slate-200 shadow-sm hover:shadow-xl hover:border-indigo-200 transition-all group">
                                                <div className="flex justify-between items-start mb-4">
                                                    <span className="bg-slate-100 text-slate-500 text-[10px] px-2.5 py-1 rounded-lg font-black uppercase tracking-widest">{item.tipo || 'General'}</span>
                                                    <span className="text-[10px] text-slate-400 font-bold">{item.comercio}</span>
                                                </div>
                                                <h3 className="font-bold text-slate-800 text-lg mb-8 line-clamp-2 h-14 group-hover:text-indigo-600 transition-colors leading-tight">{item.articulo}</h3>
                                                <div className="space-y-4 pt-4 border-t border-slate-50">
                                                    <div className="flex justify-between items-center">
                                                        <span className="text-[10px] font-bold text-slate-400 uppercase">Unitario $</span>
                                                        <span className="text-xl font-black text-slate-900">{fmt(item.unitarioUsd, '$')}</span>
                                                    </div>
                                                    <div className="flex justify-between items-center bg-indigo-50/50 p-3 rounded-2xl">
                                                        <span className="text-[10px] font-black text-indigo-400 uppercase">Unitario Bs.</span>
                                                        <span className="text-xl font-black text-indigo-600">{fmt(item.precioUnitarioBs, 'VES')}</span>
                                                    </div>
                                                </div>
                                            </div>
                                        ))}
                                    </div>
                                ) : (
                                    <div className="bg-white rounded-[2rem] border border-slate-200 shadow-sm overflow-hidden overflow-x-auto custom-scrollbar">
                                        <table className="w-full text-left border-collapse text-xs">
                                            <thead>
                                                <tr className="bg-slate-50/50 border-b">
                                                    <th className="px-4 py-5 font-black text-slate-400 uppercase tracking-widest sticky-tipo">tipo</th>
                                                    <th className="px-4 py-5 font-black text-indigo-600 uppercase tracking-widest sticky-comicion-col">Comicion</th>
                                                    <th className="px-4 py-5 font-black text-slate-400 uppercase tracking-widest col-comercio">Comercio</th>
                                                    <th className="px-4 py-5 font-black text-slate-400 uppercase tracking-widest col-fecha">Fecha</th>
                                                    <th className="px-4 py-5 font-black text-slate-800 uppercase tracking-widest sticky-articulo">Artículo</th>
                                                    <th className="px-4 py-5 font-black text-indigo-600 uppercase tracking-widest">Cant.</th>
                                                    <th className="px-4 py-5 font-black text-indigo-600 uppercase tracking-widest">Unida</th>
                                                    <th className="px-4 py-5 font-black text-indigo-600 uppercase tracking-widest">P.Unit Bs</th>
                                                    <th className="px-4 py-5 font-black text-indigo-600 uppercase tracking-widest">IVA %</th>
                                                    <th className="px-4 py-5 font-black text-slate-400 uppercase tracking-widest">subtotal</th>
                                                    <th className="px-4 py-5 font-black text-slate-400 uppercase tracking-widest">Total Bs</th>
                                                    <th className="px-4 py-5 font-black text-indigo-600 uppercase tracking-widest">Tasa C</th>
                                                    <th className="px-4 py-5 font-black text-slate-400 uppercase tracking-widest">Costo T$</th>
                                                    <th className="px-4 py-5 font-black text-slate-400 uppercase tracking-widest">Comicion N</th>
                                                    <th className="px-4 py-5 font-black text-slate-400 uppercase tracking-widest">Ganacia</th>
                                                    <th className="px-4 py-5 font-black text-slate-400 uppercase tracking-widest">Venta</th>
                                                    <th className="px-4 py-5 font-black text-slate-900 uppercase tracking-widest">Unit $</th>
                                                    <th className="px-4 py-5 font-black text-indigo-700 uppercase tracking-widest bg-indigo-50">Unit Bs</th>
                                                    <th className="px-4 py-5"></th>
                                                </tr>
                                            </thead>
                                            <tbody className="divide-y divide-slate-100">
                                                {filteredData.map(item => (
                                                    <tr key={item.id} className="hover:bg-slate-50/50 transition-colors">
                                                        <td className="px-2 py-3 sticky-tipo">
                                                            <input className="editable-input font-bold uppercase text-slate-500" value={item.tipo} onChange={e => updateField(item.id, 'tipo', e.target.value)} />
                                                        </td>
                                                        <td className="px-2 py-3 sticky-comicion-col">
                                                            <input type="number" step="0.01" className="editable-input font-bold text-indigo-600" value={item.comicion} onChange={e => updateField(item.id, 'comicion', parseFloat(e.target.value) || 0)} />
                                                        </td>
                                                        <td className="px-2 py-3 col-comercio">
                                                            <input className="editable-input text-slate-500" value={item.comercio} onChange={e => updateField(item.id, 'comercio', e.target.value)} />
                                                        </td>
                                                        <td className="px-2 py-3 col-fecha">
                                                            <input className="editable-input text-slate-400" value={item.fecha} onChange={e => updateField(item.id, 'fecha', e.target.value)} />
                                                        </td>
                                                        <td className="px-2 py-3 sticky-articulo">
                                                            <input className="editable-input font-bold text-slate-800" value={item.articulo} onChange={e => updateField(item.id, 'articulo', e.target.value)} />
                                                        </td>
                                                        <td className="px-2 py-3 w-20">
                                                            <input type="number" className="editable-input font-bold text-indigo-600" value={item.cantidad} onChange={e => updateField(item.id, 'cantidad', parseFloat(e.target.value) || 0)} />
                                                        </td>
                                                        <td className="px-2 py-3 w-20">
                                                            <input type="number" className="editable-input font-bold text-indigo-600" value={item.unida} onChange={e => updateField(item.id, 'unida', parseFloat(e.target.value) || 0)} />
                                                        </td>
                                                        <td className="px-2 py-3 w-28">
                                                            <input type="number" className="editable-input font-bold text-indigo-600" value={item.pUnitarioBs} onChange={e => updateField(item.id, 'pUnitarioBs', parseFloat(e.target.value) || 0)} />
                                                        </td>
                                                        <td className="px-2 py-3 w-20">
                                                            <input type="number" className="editable-input font-bold text-indigo-600" value={item.iva} onChange={e => updateField(item.id, 'iva', parseFloat(e.target.value) || 0)} />
                                                        </td>
                                                        <td className="px-4 py-3 calculated-cell text-[11px] whitespace-nowrap">{fmt(item.subtotal, 'VES')}</td>
                                                        <td className="px-4 py-3 calculated-cell text-[11px] whitespace-nowrap">{fmt(item.valorTotal, 'VES')}</td>
                                                        <td className="px-2 py-3 w-28">
                                                            <input type="number" className="editable-input font-bold text-indigo-600" value={item.tasaCompra} onChange={e => updateField(item.id, 'tasaCompra', parseFloat(e.target.value) || 0)} />
                                                        </td>
                                                        <td className="px-4 py-3 calculated-cell text-[11px] whitespace-nowrap">{fmt(item.costoTotalUsd, 'USD')}</td>
                                                        <td className="px-4 py-3 calculated-cell text-[11px] whitespace-nowrap">{fmt(item.comicion2, 'USD')}</td>
                                                        <td className="px-4 py-3 calculated-cell text-[11px] whitespace-nowrap">{fmt(item.ganacia, 'USD')}</td>
                                                        <td className="px-4 py-3 calculated-cell text-[11px] whitespace-nowrap">{fmt(item.venta, 'USD')}</td>
                                                        <td className="px-4 py-3 calculated-cell text-[11px] whitespace-nowrap font-black text-slate-900">{fmt(item.unitarioUsd, 'USD')}</td>
                                                        <td className="px-4 py-3 bg-indigo-50/50 font-black text-indigo-700 whitespace-nowrap">{fmt(item.precioUnitarioBs, 'VES')}</td>
                                                        <td className="px-4 py-3 text-right">
                                                            <button onClick={() => setData(data.filter(i => i.id !== item.id))} className="text-red-300 hover:text-red-500 transition-colors">
                                                                <svg className="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"></path></svg>
                                                            </button>
                                                        </td>
                                                    </tr>
                                                ))}
                                            </tbody>
                                        </table>
                                    </div>
                                )}
                            </div>
                        )}
                    </main>

                    <footer className="py-8 px-6 text-center">
                        <div className="max-w-[1800px] mx-auto flex flex-col md:flex-row justify-between items-center text-[10px] text-slate-400 font-bold uppercase tracking-[0.2em]">
                            <span>© {new Date().getFullYear()} Inventario Pro Enterprise</span>
                            <div className="flex gap-6 mt-4 md:mt-0">
                                <span className="flex items-center gap-1"><div className="w-2 h-2 rounded-full bg-indigo-400"></div> Columnas Sticky: Fijas</span>
                                <span className="flex items-center gap-1"><div className="w-2 h-2 rounded-full bg-slate-300"></div> Campos Grises: Fórmulas</span>
                            </div>
                        </div>
                    </footer>
                </div>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>
